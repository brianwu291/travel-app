(this.webpackJsonptravel=this.webpackJsonptravel||[]).push([[0],{216:function(t,e,n){"use strict";n.r(e);var r=n(0),c=n(39),i=n.n(c),a=n(27),o=n(64),u=(n(169),n(14)),s=n(232),l=n(116),p=n(229),b=30,d={"\u81fa\u5317\u5e02":"Taipei","\u65b0\u5317\u5e02":"NewTaipei","\u6843\u5712\u5e02":"Taoyuan","\u81fa\u4e2d\u5e02":"Taichung","\u81fa\u5357\u5e02":"Tainan","\u9ad8\u96c4\u5e02":"Kaohsiung","\u57fa\u9686\u5e02":"Keelung","\u65b0\u7af9\u5e02":"Hsinchu","\u65b0\u7af9\u7e23":"HsinchuCounty","\u82d7\u6817\u7e23":"MiaoliCounty","\u5f70\u5316\u7e23":"ChanghuaCounty","\u5357\u6295\u7e23":"NantouCounty","\u96f2\u6797\u7e23":"YunlinCounty","\u5609\u7fa9\u7e23":"ChiayiCounty","\u5609\u7fa9\u5e02":"Chiayi","\u5c4f\u6771\u7e23":"PingtungCounty","\u5b9c\u862d\u7e23":"YilanCounty","\u82b1\u84ee\u7e23":"HualienCounty","\u81fa\u6771\u7e23":"TaitungCounty","\u91d1\u9580\u7e23":"KinmenCounty","\u6f8e\u6e56\u7e23":"PenghuCounty","\u9023\u6c5f\u7e23":"LienchiangCounty"},j=n(7),m=Object.keys(d).map((function(t){var e=d[t];return{key:e,value:e,text:t}})),v=function(t){var e=t.defaultCityName,n=Object(u.g)(),c=Object(r.useState)(e||""),i=Object(l.a)(c,2),a=i[0],o=i[1];return Object(r.useEffect)((function(){null===e&&o("")}),[e]),Object(j.jsx)(p.a,{placeholder:"\u9078\u64c7\u4f60\u7684\u57ce\u5e02",options:m,onChange:function(t,e){o(e.value),n.push("/scenicSpot/".concat(e.value))},value:a})},h=function(){var t=Object(u.h)("/scenicSpot/:cityName")||{},e=t.isExact,n=t.params;return Object(j.jsx)("div",{style:{position:"fixed",top:"-1rem",left:0,width:"100%"},children:Object(j.jsxs)(s.a.Group,{horizontal:!0,children:[Object(j.jsx)(s.a,{textAlign:"center",children:Object(j.jsx)(o.b,{to:"/scenicSpot",children:Object(j.jsx)("div",{style:{lineHeight:"38px"},children:"\u9996\u9801"})})}),Object(j.jsx)(s.a,{textAlign:"center",children:Object(j.jsx)(v,{defaultCityName:e?null===n||void 0===n?void 0:n.cityName:null})})]})})},f=n(18),O=n.n(f),g=n(227),y=n(230),N=n(228),x="GET_SPOTS_REQUEST";var S="GET_SPOTS_SUCCESS";function k(t){var e=t.spots,n=void 0===e?[]:e,r=t.totalNumber,c=void 0===r?30:r,i=t.skipNumber;return{type:S,payload:{spots:n,totalNumber:c,skipNumber:void 0===i?0:i}}}var C="GET_CITY_REQUEST";var T="GET_CITY_SUCCESS";function w(t){var e=t.cityName,n=void 0===e?"":e,r=t.citySpots,c=void 0===r?[]:r,i=t.totalNumber,a=void 0===i?30:i,o=t.skipNumber;return{type:T,payload:{cityName:n,citySpots:c,totalNumber:a,skipNumber:void 0===o?0:o}}}var E=function(t){var e=t.triggerAtFirst,n=void 0===e||e,c=t.triggerFunction,i=void 0===c?function(){}:c,a=t.paramForTriggerFunction,o=void 0===a?{}:a,u=t.otherTriggerConditions,s=void 0===u?[]:u,p=t.forceRetriggerCondition,b=void 0===p?[]:p,d=Object(r.useState)(n),j=Object(l.a)(d,2),m=j[0],v=j[1],h=Object(r.useRef)(null),f=Object(r.useCallback)((function(){s.length>0&&s.every((function(t){return!0===t}))&&h.current&&(function(t){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}(h.current)&&v(!0))}),[s]);return Object(r.useEffect)((function(){b.length>0&&b.every((function(t){return!0===t}))&&v(!0)}),[b]),Object(r.useEffect)((function(){m&&(i(o||void 0),v(!1))}),[m,i,o]),Object(r.useEffect)((function(){return document.addEventListener("scroll",f),function(){document.removeEventListener("scroll",f)}}),[f]),{bottomElementRef:h}},F=n(226),D=function(t){var e=t.refsForLastItem,n=t.Name,r=t.Description,c=t.DescriptionDetail;return Object(j.jsxs)("div",{ref:e,role:"listitem",className:"item",children:[Object(j.jsx)(y.a.Icon,{name:"marker"}),Object(j.jsxs)(y.a.Content,{children:[Object(j.jsx)(y.a.Header,{as:"a",children:n}),Object(j.jsx)(y.a.Description,{children:r||c})]}),Object(j.jsx)(F.a,{})]})},P=Object(r.memo)(D),_=function(){var t=Object(a.c)((function(t){return O()(t,"spots.currentPage",0)})),e=Object(a.c)((function(t){return O()(t,"spots.spots",[])})),n=Object(a.c)((function(t){return O()(t,"spots.isFetching",!1)})),c=Object(a.c)((function(t){return O()(t,"spots.isFetchingDone",!1)})),i=Object(a.b)(),o=Object(r.useCallback)((function(){i(function(t){var e=t.totalNumber,n=void 0===e?30:e,r=t.skipNumber;return{type:x,payload:{totalNumber:n,skipNumber:void 0===r?0:r}}}({totalNumber:b,skipNumber:t*b}))}),[t,i]),u=E({triggerAtFirst:0===(null===e||void 0===e?void 0:e.length),triggerFunction:o,paramForTriggerFunction:null,otherTriggerConditions:[(null===e||void 0===e?void 0:e.length)>0,!n,!c]}).bottomElementRef;return Object(j.jsxs)(g.a,{style:{marginTop:"100px"},children:[Object(j.jsx)(y.a,{children:e.map((function(t,e,n){var r=t.ID,c=t.Name,i=t.Description,a=t.DescriptionDetail;return Object(j.jsx)(P,{refsForLastItem:e===n.length-1?u:null,Name:c,Description:i,DescriptionDetail:a},r)}))}),n&&Object(j.jsx)("div",{style:{height:55},children:Object(j.jsx)(N.a,{active:!0,inline:"centered"})})]})},R=function(t){var e=t.cityName,n=Object(a.c)((function(t){return O()(t,"cities.".concat(e,".currentPage"),0)})),c=Object(a.c)((function(t){return O()(t,"cities.".concat(e,".citySpots"),[])})),i=Object(a.c)((function(t){return O()(t,"cities.".concat(e,".isFetching"),!1)})),o=Object(a.c)((function(t){return O()(t,"cities.".concat(e,".isFetchingDone"),!1)})),u=function(t){var e=Object(r.useRef)();return Object(r.useEffect)((function(){e.current=t})),e.current}(e),s=Object(a.b)(),l=Object(r.useCallback)((function(){s(function(t){var e=t.totalNumber,n=void 0===e?30:e,r=t.skipNumber,c=void 0===r?0:r,i=t.cityName;return{type:C,payload:{totalNumber:n,skipNumber:c,cityName:void 0===i?"":i}}}({cityName:e,totalNumber:b,skipNumber:n*b}))}),[e,n,s]),p=E({triggerAtFirst:0===(null===c||void 0===c?void 0:c.length),triggerFunction:l,paramForTriggerFunction:null,otherTriggerConditions:[(null===c||void 0===c?void 0:c.length)>0,!i,!o],forceRetriggerCondition:[0===(null===c||void 0===c?void 0:c.length),u!==e&&!o]}).bottomElementRef;return Object(j.jsxs)(g.a,{style:{marginTop:"100px"},children:[Object(j.jsx)(y.a,{children:c.map((function(t,e,n){var r=t.ID,c=t.Name,i=t.Description,a=t.DescriptionDetail;return Object(j.jsx)(P,{refsForLastItem:e===n.length-1?p:null,Name:c,Description:i,DescriptionDetail:a},r)}))}),i&&Object(j.jsx)("div",{style:{height:55},children:Object(j.jsx)(N.a,{active:!0,inline:"centered"})})]})};var I=function(){return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(h,{}),Object(j.jsxs)(u.d,{children:[Object(j.jsx)(u.b,{exact:!0,path:"/scenicSpot",children:Object(j.jsx)(_,{})}),Object(j.jsx)(u.b,{path:"/scenicSpot/:cityName",children:function(t){var e=t.match.params.cityName;return Object(j.jsx)(R,{cityName:e})}}),Object(j.jsx)(u.b,{exact:!0,path:"/",render:function(){return Object(j.jsx)(u.a,{to:"/scenicSpot"})}})]})]})},G=n(36),H=n(150),L=n(19),$=n.n(L),A=n(37),J=n(115);var M=function(t){var e=t.path,n=t.method,r=void 0===n?"GET":n,c=t.headers,i=t.body,a=c;a||(a={});var o=a&&"application/json"===a["Content-Type"]?JSON.stringify(i):i,u={method:r||"GET",timeout:12e4};a&&(u.headers=a),o&&(u.body=o);var s="".concat("https://ptx.transportdata.tw/MOTC/v2/Tourism").concat(e);return fetch(s,u).then((function(t){return t.json().then((function(e){var n={status:t.status,data:e};return t.ok?Promise.resolve(n):Promise.reject(n)}))}))};function U(t){return Y.apply(this,arguments)}function Y(){return(Y=Object(J.a)($.a.mark((function t(e){var n,r,c,i,a,o;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.totalNumber,r=void 0===n?30:n,c=e.skipNumber,i=void 0===c?0:c,t.next=3,M({path:"/ScenicSpot/?$top=".concat(r,"&$skip=").concat(i,"&$format=JSON"),method:"GET"});case 3:return a=t.sent,o=a.data,t.abrupt("return",{spots:o,newTotal:r,newSkip:i+r});case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var K=$.a.mark(Q),B=$.a.mark(W);function Q(t){var e,n,r,c,i,a,o;return $.a.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return e=O()(t,"payload",{}),n=e.totalNumber,r=e.skipNumber,u.next=3,Object(A.b)(U,{totalNumber:n,skipNumber:r});case 3:return c=u.sent,i=c.spots,a=c.newTotal,o=c.newSkip,u.next=9,Object(A.c)(k({spots:i,totalNumber:a,skipNumber:o}));case 9:case"end":return u.stop()}}),K)}function W(){return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(A.d)(x,Q);case 2:case"end":return t.stop()}}),B)}function X(t){return z.apply(this,arguments)}function z(){return(z=Object(J.a)($.a.mark((function t(e){var n,r,c,i,a,o,u,s;return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.cityName,r=void 0===n?"":n,c=e.totalNumber,i=void 0===c?30:c,a=e.skipNumber,o=void 0===a?0:a,t.next=3,M({path:"/ScenicSpot/".concat(r,"?$top=").concat(i,"&$skip=").concat(o,"&$format=JSON"),method:"GET"});case 3:return u=t.sent,s=u.data,t.abrupt("return",{citySpots:s,newTotal:i,newSkip:o+i});case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var V=$.a.mark(Z),q=$.a.mark(tt);function Z(t){var e,n,r,c,i,a,o,u;return $.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return e=O()(t,"payload",{}),n=e.cityName,r=e.totalNumber,c=e.skipNumber,s.next=3,Object(A.b)(X,{cityName:n,totalNumber:r,skipNumber:c});case 3:return i=s.sent,a=i.citySpots,o=i.newTotal,u=i.newSkip,s.next=9,Object(A.c)(w({cityName:n,citySpots:a,totalNumber:o,skipNumber:u}));case 9:case"end":return s.stop()}}),V)}function tt(){return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(A.d)(C,Z);case 2:case"end":return t.stop()}}),q)}var et=$.a.mark(nt);function nt(){return $.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(A.a)([W(),tt()]);case 2:case"end":return t.stop()}}),et)}var rt=n(148),ct=n(29),it={spots:[],currentPage:0,isFetching:!1,isFetchingDone:!1};var at=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case x:return Object(ct.a)(Object(ct.a)({},t),{},{isFetching:!0});case S:var n=Object(rt.a)(t.spots),r=O()(e,"payload.spots",[]),c=0===(null===r||void 0===r?void 0:r.length),i=O()(e,"payload.skipNumber",0),a=Math.floor(i/b);return{isFetching:!1,isFetchingDone:c,spots:n.concat(r),currentPage:c?t.currentPage:a};default:return t}},ot=n(88),ut=Object.keys(d).reduce((function(t,e){var n=d[e],r=Object(ct.a)({},t);return r[n]={citySpots:[],currentPage:0,isFetching:!1,isFetchingDone:!1},r}),{});var st=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ut,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case C:var n=(null===e||void 0===e?void 0:e.payload)||{},r=n.cityName,c=t[r]||{};return Object(ct.a)(Object(ct.a)({},t),{},Object(ot.a)({},r,Object(ct.a)(Object(ct.a)({},c),{},{isFetching:!0})));case T:var i=(null===e||void 0===e?void 0:e.payload)||{},a=i.cityName,o=i.citySpots,u=i.skipNumber,s=t[a]||{},l=0===(null===o||void 0===o?void 0:o.length),p=Math.floor(u/b);return Object(ct.a)(Object(ct.a)({},t),{},Object(ot.a)({},a,Object(ct.a)(Object(ct.a)({},s),{},{citySpots:O()(s,"citySpots",[]).concat(o),currentPage:l?s.currentPage:p,isFetching:!1,isFetchingDone:l})));default:return t}},lt=Object(G.c)({spots:at,cities:st}),pt=Object(H.a)(),bt=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||G.d,dt=Object(G.e)(lt,bt(Object(G.a)(pt)));pt.run(nt);var jt=dt;i.a.render(Object(j.jsx)(a.a,{store:jt,children:Object(j.jsx)(o.a,{basename:"/travel-app",children:Object(j.jsx)(I,{})})}),document.getElementById("root"))}},[[216,1,2]]]);
//# sourceMappingURL=main.80420ced.chunk.js.map